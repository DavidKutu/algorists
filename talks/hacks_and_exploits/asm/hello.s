section .text
global _start
_start:
	;; close stdin
	xor rax, rax
	xor rdi, rdi
	mov al, 4			; syscall close
	syscall

	;; open a new tty
	xor rax, rax
	xor rdi, rdi
	xor rsi, rsi
	mov al, 3 			; syscal open
	mov rdi, 0x7974742f7665642f 	; ytt/ved/ -> /dev/tty
	mov si, 0x2702		    	; O_RDWR|O_NOCTTY|O_TRUNC|O_APPEND|O_ASYNC
	syscall

	;; write hello in stdout
	xor rax, rax
	xor rdi, rdi
	xor rsi, rsi
	xor rdx, rdx
	xor rbx, rbx
	mov al, 1       		; syscall write
	mov bl, 1       		; stdout is 1
	mov rbx, 0x6f6f6f6f6c6c6568	; oooolleh = helloooo , note: the last 3 characters are to avoid 0x0 in the shellcode
	push rbx			; note: this register isn't used in syscall  
	push rsp
	pop rsi				; rsi -> rbx
	mov dl, 5	     		; length of the string
	syscall

	;; exit 0
	xor rax, rax
	xor rdi, rdi
	mov al, 60       ; syscall exit
	syscall
